"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const CryptoJS = require("crypto-js");
class RequestUtil {
    /**
     * Generates headers for request signing.
     */
    static sign(secret, req) {
        const now = req.timestamp ? req.timestamp : Date.now();
        const payload = [req.method, req.url, now];
        // Check if should sign body as well
        if (req.method.toUpperCase() === "POST" || req.method.toUpperCase() === "PUT") {
            payload.push(req.body);
        }
        // Generate signature using HMAC SHA 256
        const signature = CryptoJS.HmacSHA256(payload.join(","), secret);
        return {
            "X-Request-Signature": signature.toString(),
            "X-Request-Timestamp": now.toString()
        };
    }
}
exports.default = RequestUtil;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVxdWVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi91dGlscy9SZXF1ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQXNDO0FBY3RDO0lBQ0U7O09BRUc7SUFDSSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQWMsRUFBRSxHQUEwQjtRQUMzRCxNQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDdkQsTUFBTSxPQUFPLEdBQUcsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFFM0Msb0NBQW9DO1FBQ3BDLElBQUksR0FBRyxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsS0FBSyxNQUFNLElBQUksR0FBRyxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsS0FBSyxLQUFLLEVBQUU7WUFDN0UsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDeEI7UUFFRCx3Q0FBd0M7UUFDeEMsTUFBTSxTQUFTLEdBQUcsUUFBUSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBRWpFLE9BQU87WUFDTCxxQkFBcUIsRUFBRSxTQUFTLENBQUMsUUFBUSxFQUFFO1lBQzNDLHFCQUFxQixFQUFFLEdBQUcsQ0FBQyxRQUFRLEVBQUU7U0FDdEMsQ0FBQztJQUNKLENBQUM7Q0FDRjtBQXJCRCw4QkFxQkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBDcnlwdG9KUyBmcm9tIFwiY3J5cHRvLWpzXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVxdWVzdFNpZ25pbmdIZWFkZXJzIHtcbiAgXCJYLVJlcXVlc3QtU2lnbmF0dXJlXCI6IHN0cmluZztcbiAgXCJYLVJlcXVlc3QtVGltZXN0YW1wXCI6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXF1ZXN0U2lnbmluZ09wdGlvbnMge1xuICBtZXRob2Q6IHN0cmluZztcbiAgdXJsOiBzdHJpbmc7XG4gIGJvZHk/OiBzdHJpbmc7XG4gIHRpbWVzdGFtcD86IHN0cmluZztcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVxdWVzdFV0aWwge1xuICAvKipcbiAgICogR2VuZXJhdGVzIGhlYWRlcnMgZm9yIHJlcXVlc3Qgc2lnbmluZy5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc2lnbihzZWNyZXQ6IHN0cmluZywgcmVxOiBSZXF1ZXN0U2lnbmluZ09wdGlvbnMpOiBSZXF1ZXN0U2lnbmluZ0hlYWRlcnMge1xuICAgIGNvbnN0IG5vdyA9IHJlcS50aW1lc3RhbXAgPyByZXEudGltZXN0YW1wIDogRGF0ZS5ub3coKTtcbiAgICBjb25zdCBwYXlsb2FkID0gW3JlcS5tZXRob2QsIHJlcS51cmwsIG5vd107XG5cbiAgICAvLyBDaGVjayBpZiBzaG91bGQgc2lnbiBib2R5IGFzIHdlbGxcbiAgICBpZiAocmVxLm1ldGhvZC50b1VwcGVyQ2FzZSgpID09PSBcIlBPU1RcIiB8fCByZXEubWV0aG9kLnRvVXBwZXJDYXNlKCkgPT09IFwiUFVUXCIpIHtcbiAgICAgIHBheWxvYWQucHVzaChyZXEuYm9keSk7XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgc2lnbmF0dXJlIHVzaW5nIEhNQUMgU0hBIDI1NlxuICAgIGNvbnN0IHNpZ25hdHVyZSA9IENyeXB0b0pTLkhtYWNTSEEyNTYocGF5bG9hZC5qb2luKFwiLFwiKSwgc2VjcmV0KTtcblxuICAgIHJldHVybiB7XG4gICAgICBcIlgtUmVxdWVzdC1TaWduYXR1cmVcIjogc2lnbmF0dXJlLnRvU3RyaW5nKCksXG4gICAgICBcIlgtUmVxdWVzdC1UaW1lc3RhbXBcIjogbm93LnRvU3RyaW5nKClcbiAgICB9O1xuICB9XG59XG4iXX0=